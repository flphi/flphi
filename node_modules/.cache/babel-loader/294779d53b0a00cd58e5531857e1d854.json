{"remainingRequest":"C:\\Users\\Florian\\Desktop\\projet\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Florian\\Desktop\\projet\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\Florian\\Desktop\\projet\\src\\utils\\user-authentification.js","dependencies":[{"path":"C:\\Users\\Florian\\Desktop\\projet\\src\\utils\\user-authentification.js","mtime":1587235747902},{"path":"C:\\Users\\Florian\\Desktop\\projet\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Florian\\Desktop\\projet\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Florian\\Desktop\\projet\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiQzpcXFVzZXJzXFxGbG9yaWFuXFxEZXNrdG9wXFxwcm9qZXRcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJDOlxcVXNlcnNcXEZsb3JpYW5cXERlc2t0b3BcXHByb2pldFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgUmVzdENsaWVudCBmcm9tICcuLi91dGlscy9yZXN0LWNsaWVudCc7Cgp2YXIgVXNlckF1dGhlbnRpY2F0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBVc2VyQXV0aGVudGljYXRpb24oKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVXNlckF1dGhlbnRpY2F0aW9uKTsKCiAgICB0aGlzLmN1cnJlbnRVc2VyID0gbnVsbDsKICB9CgogIF9jcmVhdGVDbGFzcyhVc2VyQXV0aGVudGljYXRpb24sIFt7CiAgICBrZXk6ICJsb2dpbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIFJlc3RDbGllbnQucG9zdCgnbG9naW4nLCB7CiAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsCiAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmQKICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgdmFyIHRva2VuID0gcmVzcG9uc2UuZGF0YS50b2tlbjsKICAgICAgICAgIFJlc3RDbGllbnQuc2V0SGVhZGVyKCd4LWFjY2Vzcy10b2tlbicsIHRva2VuKTsgLy8gT2J0aWVudCBsZSB1c2VyIGF1dGhlbnRpZmnDqSBncsOiY2UgYXUgdG9rZW4KCiAgICAgICAgICBSZXN0Q2xpZW50LmdldCgnY3VycmVudF91c2VyJykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgX3RoaXMuY3VycmVudFVzZXIgPSByZXNwb25zZS5kYXRhLnVzZXI7IC8vY29uc29sZS5sb2cocmVzcG9uc2UuZGF0YS51c2VyKTsKCiAgICAgICAgICAgIHJlc29sdmUoX3RoaXMuY3VycmVudFVzZXIpOwogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAgIC8vIFNlcnZlciBlcnJvciBvciBpbnZhbGlkIHgtYWNjZXNzLXRva2VuPz8gU2VyYWl0IHBhcyBzdXBwb3PDqQogICAgICAgICAgICBfdGhpcy5jdXJyZW50VXNlciA9IG51bGw7CiAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhlcnJvcik7CiAgICAgICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgICAgICB9KTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIC8vIEJhZCB1c2VybmFtZSBvciBwYXNzd29yZAogICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc0F1dGhlbnRpY2F0ZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzQXV0aGVudGljYXRlZCgpIHsKICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFVzZXIgIT0gbnVsbDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc0N1cnJlbnRVc2VyU3VwZXJVc2VyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc0N1cnJlbnRVc2VyU3VwZXJVc2VyKCkgewogICAgICByZXR1cm4gdGhpcy5pc0F1dGhlbnRpY2F0ZWQoKSAmJiB0aGlzLmN1cnJlbnRVc2VyLnN1cGVyX3VzZXI7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0Q3VycmVudFVzZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEN1cnJlbnRVc2VyKCkgewogICAgICByZXR1cm4gdGhpcy5jdXJyZW50VXNlcjsKICAgIH0KICB9XSk7CgogIHJldHVybiBVc2VyQXV0aGVudGljYXRpb247Cn0oKTsKCmV4cG9ydCBkZWZhdWx0IG5ldyBVc2VyQXV0aGVudGljYXRpb24oKTs="},{"version":3,"sources":["C:/Users/Florian/Desktop/projet/src/utils/user-authentification.js"],"names":["RestClient","UserAuthentication","currentUser","username","password","Promise","resolve","reject","post","then","response","token","data","setHeader","get","user","catch","error","console","info","isAuthenticated","super_user"],"mappings":";;;AAAA,OAAOA,UAAP,MAAuB,sBAAvB;;IAEMC,kB;AAEJ,gCAAc;AAAA;;AACZ,SAAKC,WAAL,GAAmB,IAAnB;AACD;;;;0BAEKC,Q,EAAUC,Q,EAAU;AAAA;;AACxB,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCP,QAAAA,UAAU,CAACQ,IAAX,CAAgB,OAAhB,EAAyB;AAAEL,UAAAA,QAAQ,EAAEA,QAAZ;AAAsBC,UAAAA,QAAQ,EAAEA;AAAhC,SAAzB,EACGK,IADH,CACQ,UAACC,QAAD,EAAc;AAClB,cAAMC,KAAK,GAAGD,QAAQ,CAACE,IAAT,CAAcD,KAA5B;AACAX,UAAAA,UAAU,CAACa,SAAX,CAAqB,gBAArB,EAAuCF,KAAvC,EAFkB,CAIlB;;AACAX,UAAAA,UAAU,CAACc,GAAX,CAAe,cAAf,EAA+BL,IAA/B,CAAoC,UAACC,QAAD,EAAc;AAChD,YAAA,KAAI,CAACR,WAAL,GAAmBQ,QAAQ,CAACE,IAAT,CAAcG,IAAjC,CADgD,CAEhD;;AACAT,YAAAA,OAAO,CAAC,KAAI,CAACJ,WAAN,CAAP;AACD,WAJD,EAIGc,KAJH,CAIS,UAACC,KAAD,EAAW;AAClB;AACA,YAAA,KAAI,CAACf,WAAL,GAAmB,IAAnB;AACAgB,YAAAA,OAAO,CAACC,IAAR,CAAaF,KAAb;AACAV,YAAAA,MAAM,CAACU,KAAD,CAAN;AACD,WATD;AAUD,SAhBH,EAgBKD,KAhBL,CAgBW,UAACC,KAAD,EAAW;AAClB;AACAC,UAAAA,OAAO,CAACD,KAAR,CAAcA,KAAd;AACAV,UAAAA,MAAM,CAACU,KAAD,CAAN;AACD,SApBH;AAqBD,OAtBM,CAAP;AAuBD;;;sCAEiB;AAChB,aAAO,KAAKf,WAAL,IAAoB,IAA3B;AACD;;;6CAEwB;AACvB,aAAQ,KAAKkB,eAAL,MAA0B,KAAKlB,WAAL,CAAiBmB,UAAnD;AACD;;;qCAEgB;AACf,aAAO,KAAKnB,WAAZ;AACD;;;;;;AAGH,eAAe,IAAID,kBAAJ,EAAf","sourcesContent":["import RestClient from '../utils/rest-client';\r\n \r\nclass UserAuthentication {\r\n \r\n  constructor() {\r\n    this.currentUser = null;\r\n  }\r\n \r\n  login(username, password) {\r\n    return new Promise((resolve, reject) => {\r\n      RestClient.post('login', { username: username, password: password })\r\n        .then((response) => {\r\n          const token = response.data.token;\r\n          RestClient.setHeader('x-access-token', token);\r\n \r\n          // Obtient le user authentifié grâce au token\r\n          RestClient.get('current_user').then((response) => {\r\n            this.currentUser = response.data.user;\r\n            //console.log(response.data.user);\r\n            resolve(this.currentUser);\r\n          }).catch((error) => {\r\n            // Server error or invalid x-access-token?? Serait pas supposé\r\n            this.currentUser = null;\r\n            console.info(error);\r\n            reject(error);\r\n          })\r\n        }).catch((error) => {\r\n          // Bad username or password\r\n          console.error(error);\r\n          reject(error);\r\n        });\r\n    });\r\n  }\r\n \r\n  isAuthenticated() {\r\n    return this.currentUser != null;\r\n  }\r\n \r\n  isCurrentUserSuperUser() {\r\n    return (this.isAuthenticated() && this.currentUser.super_user);\r\n  }\r\n \r\n  getCurrentUser() {\r\n    return this.currentUser;\r\n  }\r\n}\r\n \r\nexport default new UserAuthentication();"]}]}