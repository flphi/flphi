{"remainingRequest":"C:\\Users\\Florian\\Desktop\\projet\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Florian\\Desktop\\projet\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\Florian\\Desktop\\projet\\src\\utils\\user-authentification.js","dependencies":[{"path":"C:\\Users\\Florian\\Desktop\\projet\\src\\utils\\user-authentification.js","mtime":1587680501272},{"path":"C:\\Users\\Florian\\Desktop\\projet\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Florian\\Desktop\\projet\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Florian\\Desktop\\projet\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiQzpcXFVzZXJzXFxGbG9yaWFuXFxEZXNrdG9wXFxwcm9qZXRcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJDOlxcVXNlcnNcXEZsb3JpYW5cXERlc2t0b3BcXHByb2pldFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgUmVzdENsaWVudCBmcm9tICcuLi91dGlscy9yZXN0LWNsaWVudCc7Cgp2YXIgVXNlckF1dGhlbnRpY2F0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBVc2VyQXV0aGVudGljYXRpb24oKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVXNlckF1dGhlbnRpY2F0aW9uKTsKCiAgICB0aGlzLmN1cnJlbnRVc2VyID0gbnVsbDsKICB9CgogIF9jcmVhdGVDbGFzcyhVc2VyQXV0aGVudGljYXRpb24sIFt7CiAgICBrZXk6ICJsb2dpbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIFJlc3RDbGllbnQucG9zdCgnbG9naW4nLCB7CiAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsCiAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmQKICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgdmFyIHRva2VuID0gcmVzcG9uc2UuZGF0YS50b2tlbjsKICAgICAgICAgIFJlc3RDbGllbnQuc2V0SGVhZGVyKCd4LWFjY2Vzcy10b2tlbicsIHRva2VuKTsKICAgICAgICAgIGNvbnNvbGUuaW5mbygnVE9LRU4gUkVDVSBEVSBTRVJWRVVSPScgKyB0b2tlbik7IC8vIE9idGllbnQgbGUgdXNlciBhdXRoZW50aWZpw6kgZ3LDomNlIGF1IHRva2VuCgogICAgICAgICAgUmVzdENsaWVudC5nZXQoJ2N1cnJlbnRfdXNlcicpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgIF90aGlzLmN1cnJlbnRVc2VyID0gcmVzcG9uc2UuZGF0YS51c2VyOyAvL2NvbnNvbGUubG9nKHJlc3BvbnNlLmRhdGEudXNlcik7CgogICAgICAgICAgICByZXNvbHZlKF90aGlzLmN1cnJlbnRVc2VyKTsKICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgICAvLyBTZXJ2ZXIgZXJyb3Igb3IgaW52YWxpZCB4LWFjY2Vzcy10b2tlbj8/IFNlcmFpdCBwYXMgc3VwcG9zw6kKICAgICAgICAgICAgX3RoaXMuY3VycmVudFVzZXIgPSBudWxsOwogICAgICAgICAgICBjb25zb2xlLmluZm8oZXJyb3IpOwogICAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgICAgfSk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAvLyBCYWQgdXNlcm5hbWUgb3IgcGFzc3dvcmQKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNBdXRoZW50aWNhdGVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc0F1dGhlbnRpY2F0ZWQoKSB7CiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRVc2VyICE9IG51bGw7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNDdXJyZW50VXNlclN1cGVyVXNlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaXNDdXJyZW50VXNlclN1cGVyVXNlcigpIHsKICAgICAgcmV0dXJuIHRoaXMuaXNBdXRoZW50aWNhdGVkKCkgJiYgdGhpcy5jdXJyZW50VXNlci5zdXBlcl91c2VyOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEN1cnJlbnRVc2VyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDdXJyZW50VXNlcigpIHsKICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFVzZXI7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gVXNlckF1dGhlbnRpY2F0aW9uOwp9KCk7CgpleHBvcnQgZGVmYXVsdCBuZXcgVXNlckF1dGhlbnRpY2F0aW9uKCk7"},{"version":3,"sources":["C:/Users/Florian/Desktop/projet/src/utils/user-authentification.js"],"names":["RestClient","UserAuthentication","currentUser","username","password","Promise","resolve","reject","post","then","response","token","data","setHeader","console","info","get","user","catch","error","isAuthenticated","super_user"],"mappings":";;;AAAA,OAAOA,UAAP,MAAuB,sBAAvB;;IAEMC,kB;AAEJ,gCAAc;AAAA;;AACZ,SAAKC,WAAL,GAAmB,IAAnB;AACD;;;;0BAEKC,Q,EAAUC,Q,EAAU;AAAA;;AACxB,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCP,QAAAA,UAAU,CAACQ,IAAX,CAAgB,OAAhB,EAAyB;AAAEL,UAAAA,QAAQ,EAAEA,QAAZ;AAAsBC,UAAAA,QAAQ,EAAEA;AAAhC,SAAzB,EACGK,IADH,CACQ,UAACC,QAAD,EAAc;AAClB,cAAMC,KAAK,GAAGD,QAAQ,CAACE,IAAT,CAAcD,KAA5B;AACAX,UAAAA,UAAU,CAACa,SAAX,CAAqB,gBAArB,EAAuCF,KAAvC;AACAG,UAAAA,OAAO,CAACC,IAAR,CAAa,2BAA2BJ,KAAxC,EAHkB,CAKlB;;AACAX,UAAAA,UAAU,CAACgB,GAAX,CAAe,cAAf,EAA+BP,IAA/B,CAAoC,UAACC,QAAD,EAAc;AAChD,YAAA,KAAI,CAACR,WAAL,GAAmBQ,QAAQ,CAACE,IAAT,CAAcK,IAAjC,CADgD,CAEhD;;AACAX,YAAAA,OAAO,CAAC,KAAI,CAACJ,WAAN,CAAP;AACD,WAJD,EAIGgB,KAJH,CAIS,UAACC,KAAD,EAAW;AAClB;AACA,YAAA,KAAI,CAACjB,WAAL,GAAmB,IAAnB;AACAY,YAAAA,OAAO,CAACC,IAAR,CAAaI,KAAb;AACAZ,YAAAA,MAAM,CAACY,KAAD,CAAN;AACD,WATD;AAUD,SAjBH,EAiBKD,KAjBL,CAiBW,UAACC,KAAD,EAAW;AAClB;AACAL,UAAAA,OAAO,CAACK,KAAR,CAAcA,KAAd;AACAZ,UAAAA,MAAM,CAACY,KAAD,CAAN;AACD,SArBH;AAsBD,OAvBM,CAAP;AAwBD;;;sCAEiB;AAChB,aAAO,KAAKjB,WAAL,IAAoB,IAA3B;AACD;;;6CAEwB;AACvB,aAAQ,KAAKkB,eAAL,MAA0B,KAAKlB,WAAL,CAAiBmB,UAAnD;AACD;;;qCAEgB;AACf,aAAO,KAAKnB,WAAZ;AACD;;;;;;AAGH,eAAe,IAAID,kBAAJ,EAAf","sourcesContent":["import RestClient from '../utils/rest-client';\r\n \r\nclass UserAuthentication {\r\n \r\n  constructor() {\r\n    this.currentUser = null;\r\n  }\r\n \r\n  login(username, password) {\r\n    return new Promise((resolve, reject) => {\r\n      RestClient.post('login', { username: username, password: password })\r\n        .then((response) => {\r\n          const token = response.data.token;\r\n          RestClient.setHeader('x-access-token', token);\r\n          console.info('TOKEN RECU DU SERVEUR=' + token);\r\n \r\n          // Obtient le user authentifié grâce au token\r\n          RestClient.get('current_user').then((response) => {\r\n            this.currentUser = response.data.user;\r\n            //console.log(response.data.user);\r\n            resolve(this.currentUser);\r\n          }).catch((error) => {\r\n            // Server error or invalid x-access-token?? Serait pas supposé\r\n            this.currentUser = null;\r\n            console.info(error);\r\n            reject(error);\r\n          })\r\n        }).catch((error) => {\r\n          // Bad username or password\r\n          console.error(error);\r\n          reject(error);\r\n        });\r\n    });\r\n  }\r\n \r\n  isAuthenticated() {\r\n    return this.currentUser != null;\r\n  }\r\n \r\n  isCurrentUserSuperUser() {\r\n    return (this.isAuthenticated() && this.currentUser.super_user);\r\n  }\r\n \r\n  getCurrentUser() {\r\n    return this.currentUser;\r\n  }\r\n}\r\n \r\nexport default new UserAuthentication();"]}]}